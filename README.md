# CVE-2020-0668

powershell 实现，利用[printconfig.dll](https://github.com/Nan3r/writedacl2system/tree/master/printconfig.dll)来提权

[evil dll](https://github.com/Nan3r/dll/tree/master/common%20dll/run_programdata_setup.bat)可以自己定义，我这里的dll会执行c:\programdata\setup.bat文件

这里dll生成有问题，不能生成原大小的evil DLL，导致出错。

移动到目标dll，只能有4k，因为代码里面设置了4k大小的maxsize。
原理：evil dll必须要大于maxsize，但是又只能移动maxsize大小过去，这不是利用不了了吗?（这里自己的psh脚本跟作者的C#脚本测试一样）
所以去又去作者博客看了看exp gif图，发现了好像有个复制操作，复制了WindowsCoreDeviceInfo.dll,我就查看了下我这个printconfig.dll权限：

![](poc.png)

原来是给当前用户了Full权限，那就可以重新复制evil dll 提权，可是我看作者博客和MSRC的链接，都没有提到这个。

有没有大佬可以解释下~



## Reference:

https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0668

https://itm4n.github.io/cve-2020-0668-windows-service-tracing-eop



## TODO：

​	1.利用RASPLAP服务提权  https://github.com/NotGlop/SysExec/blob/master/source/SysExec.cpp 

​	2.利用RASMAN服务提权